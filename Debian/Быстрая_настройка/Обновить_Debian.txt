Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2022-02-23T00:50:15+02:00

====== Обновить Debian ======

< @debian @update >

===== Проверить версию и релиз Debian =====

''cat /etc/os-release''

или весьма подробно

''hostnamectl''

Ранее для этого использовали  составную команду «''lsb_release -d && cat /etc/debian_version''», но ''lsb'' ([[https://wiki.linuxfoundation.org/lsb/start|Linux Standard Base]]) отменена.

===== Дежурное обновление системы =====

''sudo apt-get update && sudo apt-get upgrade''

===== Обновление до определённого ядра =====

Сперва [[../../../Фишки_Linux/Как_узнать_какие_ядра_есть_в_системе.txt|надо знать точный номер ядра]], к которому нужно обновиться, и причина для обновления должна быть обоснована. 

	Всегда есть вероятность нафакапиться, поэтому продвигаться надо осторожно, всегда проверяя, можно ли откатиться к предыдущему состоянию. 
	
	При обновлении ядер разумно поставить их несколько совместно и явно указать в загрузке более новое. Если что — откатиться.

''sudo aptitude update''
	
Списки пакетов обновляются из всех репозиториев, указанных в файле /etc/apt/sources.list а также в Система > Менеджер пакетов Synaptic > Настройки > Репозитории > Other Software 

	1. ''sudo aptitude install REQUIRED-linux-image-version''
	2. ''sudo reboot''

Если после загрузки все идёт хорошо, тогда подтягиваем зависимости для нового ядра, разрешив Debian автоматом удалять старые зависимости:

''sudo aptitude full-upgrade''

===== Обновление до нового релиза =====

Отслеживать порядковый номер и имя доступных релизов — https://www.debian.org/releases/

==== Обновить sources.list ====

[[Обновить sources.list]] по имени нового релиза.

Очень внимательно посмотреть, если в сети никто не ругается на обновления.

==== Обновить систему до нового релиза ====

''sudo aptitude full-upgrade''

Команда //full-upgrade// изначально назвывалась //dist-upgrade//. aptitude все ещё распознает dist-upgrade как синоним full-upgrade. Но «//aptitude full-upgrade»// обновляет установленные пакеты до их наиболее свежих версий, удаляя или устанавливая пакеты, если это необходимо. Также выполняется установка новых необходимых и требующихся пакетов. Эта команда менее консервативна (более агрессивна) чем «//safe-upgrade»//, и потому более вероятно, что она произведёт нежелательные действия. Тем не менее, она способна обновить пакеты, которые не могут быть обновлены командной «//safe-upgrade//».

Если в командной строке после этой команды не указан ни один пакет, aptitude попытается обновить //каждый// пакет, который может быть обновлен. 

После обновления нужно „''sudo reboot''” чтобы посмотреть, что получилось. 

	Обычно надо заново настроить [[Linux:Настройки KDE:Клавиатура:Поменять местами символы на клавише точки и запятой в русской раскладке]], иногда меняется конфиг для [[grub2]].

=== Простое и бесконтрольное обновление ===

Чревато последствиями, но если бессмертно и бесстрашно…

	1. ''sudo apt update''
	2. ''sudo apt dist-upgrade''

==== Если обновления проверяются только из кэша ====

[[Linux:HowTo:Как заставить aptitude обновляться из сети, а не из кэша]]
